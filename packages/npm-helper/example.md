# tang-npm ä½¿ç”¨ç¤ºä¾‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. æ£€æŸ¥ç¯å¢ƒ

```bash
npm run check
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ” æ£€æŸ¥å‘å¸ƒå‰å‡†å¤‡çŠ¶æ€...

âœ… Node.jsç‰ˆæœ¬: v16.14.2
âœ… Node.jsç‰ˆæœ¬ç¬¦åˆè¦æ±‚
âœ… npmç‰ˆæœ¬: 8.5.0
âœ… package.jsoné…ç½®æ£€æŸ¥:
   åŒ…å: tang-npm
   ç‰ˆæœ¬: 1.0.0
   æè¿°: ä¸€ä¸ªç”¨äºä¸€é”®è‡ªåŠ¨tagã€å‘åŒ…ã€å¼•å¯¼ç™»å½•npmçš„å·¥å…·
   ä¸»æ–‡ä»¶: index.js
   è®¸å¯è¯: ISC
âœ… package.jsoné…ç½®å®Œæ•´
âœ… å­˜åœ¨.npmignoreæ–‡ä»¶
âœ… Gité…ç½®:
   ç”¨æˆ·å: å”è´
   é‚®ç®±: itangbei@sina.com
âœ… è¿œç¨‹ä»“åº“é…ç½®:
origin  git@github.com:tangbei/tang-npm-monorepo.git (fetch)
origin  git@github.com:tangbei/tang-npm-monorepo.git (push)

ğŸ“‹ å‘å¸ƒå‰æ£€æŸ¥æ¸…å•:
â–¡ ç¡®ä¿æ‰€æœ‰ä»£ç å·²æäº¤åˆ°git
â–¡ ç¡®ä¿åœ¨æ­£ç¡®çš„åˆ†æ”¯ä¸Š (main/master)
â–¡ ç¡®ä¿npmå·²ç™»å½•
â–¡ ç¡®ä¿package.jsonä¸­çš„ç‰ˆæœ¬å·æ­£ç¡®
â–¡ ç¡®ä¿.npmignoreæ–‡ä»¶é…ç½®æ­£ç¡®
â–¡ ç¡®ä¿README.mdæ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹å®Œæ•´

ğŸš€ è¿è¡Œ npm run release å¼€å§‹å‘å¸ƒæµç¨‹
```

### 3. æ‰§è¡Œå‘å¸ƒ

```bash
npm run release
```

å‘å¸ƒæµç¨‹ç¤ºä¾‹ï¼š
```
ğŸš€ å¼€å§‹ä¸€é”®å‘å¸ƒæµç¨‹...

ğŸ“‹ æ£€æŸ¥gitçŠ¶æ€...
âœ… gitå·¥ä½œåŒºå¹²å‡€

ğŸŒ¿ æ£€æŸ¥gitåˆ†æ”¯...
âœ… å½“å‰åˆ†æ”¯: main

ğŸ“¦ è·å–ç‰ˆæœ¬ä¿¡æ¯...
âœ… ç‰ˆæœ¬ä¿¡æ¯:
   å½“å‰ç‰ˆæœ¬: 1.0.0
   æœ€æ–°ç‰ˆæœ¬: 0.0.0

? é€‰æ‹©ç‰ˆæœ¬æ›´æ–°ç±»å‹: (ä½¿ç”¨ç®­å¤´é”®é€‰æ‹©)
â¯ è¡¥ä¸ç‰ˆæœ¬ (patch) - 1.0.0 â†’ 1.0.1
  æ¬¡è¦ç‰ˆæœ¬ (minor) - 1.0.0 â†’ 1.1.0
  ä¸»è¦ç‰ˆæœ¬ (major) - 1.0.0 â†’ 2.0.0
  è‡ªå®šä¹‰ç‰ˆæœ¬

? ç¡®è®¤è¦å‘å¸ƒ tang-npm å—? (Y/n)

ğŸ” æ£€æŸ¥npmç™»å½•çŠ¶æ€...
âœ… å·²ç™»å½•npmï¼Œç”¨æˆ·å: your-username

ğŸ“ æ›´æ–°ç‰ˆæœ¬å·...
âœ… ç‰ˆæœ¬å·²æ›´æ–°ä¸º: 1.0.1

ğŸ·ï¸ åˆ›å»ºgit tag...
âœ… Git tag v1.0.1 å·²åˆ›å»ºå¹¶æ¨é€

ğŸš€ æ­£åœ¨å‘å¸ƒåˆ°npm...
âœ… å‘å¸ƒæˆåŠŸï¼

ğŸ‰ å‘å¸ƒå®Œæˆï¼
ğŸ“¦ åŒ…å: tang-npm
ğŸ“‹ ç‰ˆæœ¬: 1.0.1
ğŸ”— npmåœ°å€: https://www.npmjs.com/package/tang-npm
```

## ğŸ“‹ ç‰ˆæœ¬æ›´æ–°ç¤ºä¾‹

### Patch ç‰ˆæœ¬ (ä¿®å¤bug)
```bash
# å½“å‰ç‰ˆæœ¬: 1.0.0
# é€‰æ‹©: è¡¥ä¸ç‰ˆæœ¬ (patch)
# æ–°ç‰ˆæœ¬: 1.0.1
```

### Minor ç‰ˆæœ¬ (æ–°åŠŸèƒ½)
```bash
# å½“å‰ç‰ˆæœ¬: 1.0.0
# é€‰æ‹©: æ¬¡è¦ç‰ˆæœ¬ (minor)
# æ–°ç‰ˆæœ¬: 1.1.0
```

### Major ç‰ˆæœ¬ (ç ´åæ€§æ›´æ–°)
```bash
# å½“å‰ç‰ˆæœ¬: 1.0.0
# é€‰æ‹©: ä¸»è¦ç‰ˆæœ¬ (major)
# æ–°ç‰ˆæœ¬: 2.0.0
```

### è‡ªå®šä¹‰ç‰ˆæœ¬
```bash
# å½“å‰ç‰ˆæœ¬: 1.0.0
# é€‰æ‹©: è‡ªå®šä¹‰ç‰ˆæœ¬
# è¾“å…¥: 1.2.3
# æ–°ç‰ˆæœ¬: 1.2.3
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### ç›´æ¥è¿è¡Œè„šæœ¬

```bash
# æ£€æŸ¥ç¯å¢ƒ
node scripts/check.js

# å‘å¸ƒ
node scripts/release.js

# ä½¿ç”¨å…¥å£æ–‡ä»¶
node index.js check
node index.js release
```

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# è·³è¿‡gitæ£€æŸ¥
SKIP_GIT_CHECK=true npm run release

# æŒ‡å®šnpm registry
npm config set registry https://registry.npmjs.org/
```

### è‡ªåŠ¨åŒ–å‘å¸ƒ

å¯ä»¥ç»“åˆCI/CDä½¿ç”¨ï¼š

```yaml
# GitHub Actions ç¤ºä¾‹
name: Release
on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '16'
      - run: npm install
      - run: npm run release
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

1. **npmç™»å½•å¤±è´¥**
   ```bash
   # æ¸…é™¤npmç¼“å­˜
   npm cache clean --force
   
   # é‡æ–°ç™»å½•
   npm login
   ```

2. **Gitæƒé™é—®é¢˜**
   ```bash
   # æ£€æŸ¥SSHå¯†é’¥
   ssh -T git@github.com
   
   # æˆ–ä½¿ç”¨HTTPS
   git remote set-url origin https://github.com/username/repo.git
   ```

3. **ç‰ˆæœ¬å†²çª**
   ```bash
   # æ£€æŸ¥npmä¸Šçš„ç‰ˆæœ¬
   npm view your-package-name version
   
   # æ‰‹åŠ¨æ›´æ–°package.jsonä¸­çš„ç‰ˆæœ¬
   ```

4. **å‘å¸ƒæƒé™ä¸è¶³**
   ```bash
   # æ£€æŸ¥npmç”¨æˆ·
   npm whoami
   
   # æ£€æŸ¥åŒ…çš„æ‰€æœ‰è€…
   npm owner ls your-package-name
   ```

## ğŸ“š æœ€ä½³å®è·µ

1. **å‘å¸ƒå‰æ£€æŸ¥**
   - å§‹ç»ˆè¿è¡Œ `npm run check` æ£€æŸ¥ç¯å¢ƒ
   - ç¡®ä¿æ‰€æœ‰ä»£ç å·²æäº¤
   - ç¡®ä¿åœ¨æ­£ç¡®çš„åˆ†æ”¯ä¸Š

2. **ç‰ˆæœ¬ç®¡ç†**
   - éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ
   - ä¸ºæ¯ä¸ªç‰ˆæœ¬æ·»åŠ æœ‰æ„ä¹‰çš„commit message
   - ä½¿ç”¨git tagæ ‡è®°é‡è¦ç‰ˆæœ¬

3. **æ–‡æ¡£ç»´æŠ¤**
   - ä¿æŒREADME.mdæ›´æ–°
   - è®°å½•é‡è¦çš„å˜æ›´
   - æä¾›æ¸…æ™°çš„ä½¿ç”¨ç¤ºä¾‹

4. **æµ‹è¯•**
   - å‘å¸ƒå‰è¿›è¡Œå……åˆ†æµ‹è¯•
   - ä½¿ç”¨CI/CDè‡ªåŠ¨åŒ–æµ‹è¯•
   - ä¿æŒæµ‹è¯•è¦†ç›–ç‡ 